
clc
clear all

% TEST FOR Z PATH CUT

d=1;
a=1;

A=-1;
B=-1;

mu=1;

nu=0.3;
kap=3-4*nu; % Kolosov's constant

niter=1;

N=10;

% s(i), u(i) and Weigths
auxi=1:N;
s=cos(pi*(auxi)./(N+1));
W=(1-s.^2)./(N+1);
clear auxi

% t(k)
auxk=1:N;
t=cos(pi*(2.*auxk-1)./(2.*(N+1)));
clear auxk

%s=-1:0.2:1;
%t=-1:0.2:1;

[sm,tm]=meshgrid(s,t);

% zeta=s*c/a;
% delta=t*c/a;

xism=(sm+1)*d/2;
rtm=(tm+1)*d/2;

%xi=


r=rtm;
zeta=a;
delta=a;
par=xism;
z1=zeta+delta;

k2m=(4.*par.*r)./((par+r).^2+z1.^2);
[Km,Em]=elliptic123(k2m);


[nl,nc]=size(k2m);

lh='221';

JOLD=zeros(nl,nc);

tic

% for k=1:niter
% for i=1:nl
%     for j=1:nc
%         JOLD(i,j)=LH_INTEGRALS_OLD(par(i,j),r(i,j),z1,0,Km(i,j),Em(i,j),lh);
%     end
% end
% end

toc

tic

for k=1:niter
J=LH_INTEGRALS(par,r,z1,0,Km,Em,lh)
end

Jmath=[0.0080451548	0.007496447093	0.006550503351	0.005239527921	0.003716736483	0.002246875625	0.001095608557	0.000392510445	0.00008400287671	5.485384917*10^-6
0.007695408205	0.007183003401	0.0062932742	0.005049876556	0.00359383408	0.00217866256	0.001064494178	0.0003818107378	0.00008175395453	5.339206475*10^-6
0.006967211965	0.006524580324	0.005745141809	0.004638111305	0.003321316455	0.002024313096	0.0009929432121	0.0003569563146	0.00007650642548	4.997722492*10^-6
0.005851831688	0.005504075748	0.004879374202	0.003971755333	0.002868387673	0.001761289826	0.0008686249975	0.0003132564586	0.00006723169502	4.393364584*10^-6
0.004432905265	0.004189662205	0.003742149173	0.003074401421	0.002241840875	0.001388359561	0.0006890184628	0.0002494035902	0.00005361267611	3.504819516*10^-6
0.002922734402	0.002774915087	0.002496189801	0.002068994403	0.00152283299	0.0009509763953	0.000474885183	0.0001725251173	0.00003714538292	2.429277783*10^-6
0.00160173571	0.001526209869	0.001380723229	0.001152615061	0.0008548166825	0.0005374856987	0.0002697836908	0.00009831197853	0.00002119502752	1.386613069*10^-6
0.0006805781341	0.000650012809	0.0005902431428	0.0004950543101	0.0003690066906	0.0002330898188	0.000117402177	0.00004287121774	9.250897925*10^-6	6.053437067*10^-7
0.0001960963944	0.0001875126763	0.000170592971	0.0001434253203	0.0001071842231	0.00006786517526	0.0000342434129	0.00001251792724	2.702415097*10^-6	1.768631067*10^-7
0.00002701642385	0.00002584439707	0.00002352768942	0.00001979716805	0.00001480798044	9.383548806*10^-6	4.737682151*10^-6	1.732536444*10^-6	3.741276923*10^-7	2.492622302*10^-8


]

J-Jmath

%xism.*J

toc

% toc
% 
% tic
% 
% for k=1:niter
%     
%     J2=LH_INTEGRALS(r,z,0,'213byr');
%     
% end
% 
% J2
% 
% toc
% 
% J2-J